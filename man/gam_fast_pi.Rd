% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gam_fast_pi.R
\name{gam_fast_pi}
\alias{gam_fast_pi}
\title{Fast Prediction Intervals with Monotonicity Enforcement}
\usage{
gam_fast_pi(rt_matrix, newdata, alpha = 0.05, prediction_interval = TRUE)
}
\arguments{
\item{rt_matrix}{A 2-column matrix \link{rt_source, rt_target}.}

\item{newdata}{Numeric vector of x-values for predictions.}

\item{alpha}{Significance level (default 0.05 for 95\% intervals).}

\item{prediction_interval}{Logical, if TRUE (default) adds observation
variance for prediction intervals. If FALSE, gives confidence intervals.}
}
\value{
A matrix with 3 columns: \link{predicted, lower, upper}.
}
\description{
Fast calculation of prediction intervals using single GAM fit
with post-hoc monotonicity enforcement.

Computes prediction intervals by fitting the constrained GAM once,
estimating pointwise SE, and enforcing monotonicity with cummax().
}
\details{
Algorithm:
\enumerate{
\item Fit monotonically constrained GAM to full dataset
\item Estimate pointwise SE from model variance
\item Build intervals: mean Â± k*SE (+ observation variance if PI)
\item Enforce monotonicity with cummax() on bounds
}

This is ~25x faster than bootstrap because:
\itemize{
\item Fits model only once (vs 200 times)
\item Uses analytic variance estimates (vs resampling)
}

Monotonicity enforcement:
\itemize{
\item Predictions are monotonic by construction (constrained fit)
\item Lower/upper bounds may violate due to varying SE
\item cummax() ensures bounds are also monotonic
\item May slightly overestimate uncertainty at inflection points
}
}
\keyword{internal}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gam_fitting.R
\name{gam_mono_con_fun}
\alias{gam_mono_con_fun}
\title{Monotonically Constrained GAM Bootstrap Function}
\usage{
gam_mono_con_fun(in_data, inds, newdata)
}
\arguments{
\item{in_data}{A 2-column matrix where column 1 is RT in source system
and column 2 is RT in target system.}

\item{inds}{Bootstrap resampling indices (provided by \code{boot()}).}

\item{newdata}{Numeric vector of x-values at which to predict.}
}
\value{
Numeric vector of predicted y-values at \code{newdata} points.
}
\description{
Fits a monotonically constrained GAM to bootstrap-resampled data.
This is the core fitting function used by \code{boot::boot()} for confidence
interval estimation.
}
\details{
The algorithm:
\enumerate{
\item Resample data using bootstrap indices
\item Add jitter if fewer than 4 unique x-values (needed for spline fitting)
\item Fit initial unconstrained GAM to get smoothing parameter
\item Weight observations by residuals using sigmoid function
(downweights outliers)
\item Build constrained spline with monotonic constraints
\item Fit using penalized constrained least squares
\item Predict at newdata points
}

The monotonic constraint ensures that predicted RTs maintain the
elution order assumption (if compound A elutes before B in system 1,
A should also elute before B in system 2).
}
\references{
Stanstrup et al. (2015) "PredRet: Prediction of Retention Time by
Direct Mapping between Multiple Chromatographic Systems"
Anal. Chem. 87:9421-9428
}
\keyword{internal}

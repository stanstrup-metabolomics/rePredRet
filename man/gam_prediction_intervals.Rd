% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gam_prediction_intervals.R
\name{gam_prediction_intervals}
\alias{gam_prediction_intervals}
\title{GAM Prediction Intervals via Posterior Simulation}
\usage{
gam_prediction_intervals(
  rt_matrix,
  newdata,
  n_sim = 1000,
  alpha = 0.05,
  n_cores = 1
)
}
\arguments{
\item{rt_matrix}{A 2-column matrix where column 1 is RT in source system
and column 2 is RT in target system.}

\item{newdata}{Numeric vector of x-values at which to predict.}

\item{n_sim}{Number of posterior samples (default 1000).}

\item{alpha}{Significance level for PI (default 0.05 for 95\% PI).}

\item{n_cores}{Number of cores for parallel simulation (default 1).}
}
\value{
A matrix with 3 columns: \link{predicted, lower, upper} at each
newdata point.
}
\description{
Fast calculation of prediction intervals for monotonically
constrained GAMs using posterior simulation instead of bootstrap.

Uses posterior simulation to generate prediction intervals for a
monotonically constrained GAM. This is much faster than bootstrap
because the model is only fitted once.
}
\details{
The algorithm:
\enumerate{
\item Fit constrained GAM once to full data
\item Extract coefficient vector β and covariance matrix V
\item Simulate parameter vectors: β_sim = β + L\emph{ν where V = L}L' (Cholesky)
and ν ~ N(0,1)
\item Generate predictions: pred_sim = Xp \%*\% β_sim
\item Add observation noise: y_sim ~ N(pred_sim, σ²)
\item Calculate quantiles across simulations
}

This gives TRUE prediction intervals (for future observations), not
confidence intervals (for the mean function). Prediction intervals are
wider because they include both parameter uncertainty AND observation variance.
}
\references{
Marra & Wood (2012) "Coverage properties of confidence intervals for
generalized additive model components". Scandinavian Journal of Statistics.
}
